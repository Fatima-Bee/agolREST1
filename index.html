<!DOCTYPE html>
<html lang="en">
<head>
  <title>Hello, AGOL!</title>
  <!-- meta for the browser to allow for mobile first design -->
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- <meta name="description" content="" /> -->

  <!-- calls for the arcgis api's CSS file and JS library-->
<link rel="stylesheet" href="https://js.arcgis.com/4.26/esri/themes/light/main.css" />
<script src="https://js.arcgis.com/4.26/"></script>

<!-- css to make a full screen map -->

<script>
require([ "esri/Map", "esri/views/MapView" ], (Map, MapView) => {
 });
</script>


<style>
  html,
  body,
  #viewDiv {
    padding: 0;
    margin: 0;
    height: 100%;
    width: 100%;
  }
</style>
</head>
<body>

  <!-- the div to display the map -->
   <div id="viewDiv"></div>


<!--- Adding the modules needed for a full screen map app and placing the needed things for the additional challenges-->
<script>

  require([
    "esri/config",
    "esri/Map",
    "esri/views/MapView",
    "esri/widgets/BasemapGallery",
    "esri/widgets/Locate",
    "esri/widgets/Search",
    "esri/layers/GraphicsLayer",
     "esri/Graphic",
     "esri/layers/FeatureLayer"
  ], function (esriConfig, Map, MapView, BasemapGallery, Locate, Search, GraphicsLayer, Graphic, FeatureLayer) {

    esriConfig.apiKey = "AAPTxy8BH1VEsoebNVZXo8HurN9CA4Z_pltmmtVA5PycbBd6Xh_gP36QMlUpOVbLusJYJ1Lsls6fT7M3k59AjBOhGuLwbAtYGbNGYI8P1AczbQA2fpbC6uks6oTxnkWgyyNoqWx5FNYW1j11ic7FtHw77w0O-EI3bPJ-YElfeb-LM1gF28T9Gtu0XRWpy9m0CGVgmXC-tMurlkO_cNOPceceFojFdv0wRE_9APrRvgKvOGdtQsMgtr86bdyrHx-hCHXYAT1_l9mao6ca";

    const map = new Map({
      basemap: "arcgis-colored-pencil"
    });

    const view = new MapView({
      map: map,
      center: [-84.374201, 33.784030], //Long and Lat
      zoom: 16 , //zoom level
      container: "viewDiv" //Div element
    });

//constructor for graphics layer    
    const graphicsLayer = new GraphicsLayer();  
      map.add(graphicsLayer);

    const point = { //Create a point  
      type: "point",  
      longitude: -84.371755,    //long lat of entrance to Shakey Knees off of 10th st NE and Mmedow Path
      latitude: 33.781912
    };

    const starSymbol = {  
      type: "text",
      text:  "â˜…", 
      color: [199, 0, 57],  // red
      outline: {  
      color: [255, 255, 255], // White  
      width: 1
  },
    font: {
    size: 22,                
    weight: "bold"
  },
  angle: 0                   // rotate
}; 

//popup

const popupTemplate = {
    title: "{Name}",
    content: "{Description}"
 }
 const attributes = {
    Name: "Shakey Knees Entrance",
    Description: " 10th St NE and Meadow Path"
 }

 //ppoint creation
  const pointGraphic = new Graphic({  
    geometry: point,
    symbol: starSymbol,

//popup properties
    attributes: attributes,
    popupTemplate: popupTemplate
});

  graphicsLayer.add(pointGraphic);

  //add feature layer

  const schools = new FeatureLayer({
  url: "https://services1.arcgis.com/Ua5sjt3LWTPigjyD/arcgis/rest/services/Public_School_Locations_Current/FeatureServer",
  outFields: ["*"],
  title: "USA Schools",
  popupTemplate: { title: "{NAME}" }
});

//add feature layer to map
  map.add(schools);

  const airportRenderer = {
        "type": "simple",
        "symbol": {
          "type": "picture-marker",
          "url": "https://sounny.github.io/agol/outline_local_airport_black_24dp.png", //my url wont work
          "width": "18px",
          "height": "18px"
        }
      }

//const to make the airport labels
  const airportLabels = {
    symbol: {
    type: "text",
    color: "#FFFFFF",
    haloColor: "#5E8D74",
    haloSize: "2px",
    font: {
      size: "12px",
      family: "Noto Sans",
      style: "italic",
      weight: "normal"
    }
  },
  labelPlacement: "above-center",
  labelExpressionInfo: {
    expression: "$feature.Fac_Name"
  }
};

  const airports = new FeatureLayer({
    url: "https://services.arcgis.com/HRPe58bUyBqyyiCt/ArcGIS/rest/services/US_Airports_Fatima/FeatureServer/0",
    outFields: ["*"],
    title: "US Airports",
    renderer: airportRenderer,
    popupTemplate: { title: "{NAME}", content: "{CITY}, {STATE}" },

    definitionExpression:"Fac_Type = 'AIRPORT'", //adding sql to filter for airports
    labelingInfo: [airportLabels] //adding the labels
});

  map.add(airports);



    //Basemap Gallery

    const basemapGallery = new BasemapGallery({
        view: view
    });
      view.ui.add(basemapGallery, "bottom-right");


      //Locate 

  const locateWidget = new Locate({
        view: view
      });
      view.ui.add(locateWidget, "top-left"); 

      //Search -- HOW DID I GET THIS TO WORK, NOTHING WAS WORKING AND I JUST TRIED AGAIN JUST TO TRY AND IT WORKS ??? I DID NOT DO ANYTHING DIFFRENT

  const searchWidget = new Search({
        view: view
      });
      view.ui.add(searchWidget, "top-right"); 
  
  });

</script>

  <!--- <h1>Hello, world! I am using Git!</h1>  don't delete old code because I am paranoid--->

</body>
</html>